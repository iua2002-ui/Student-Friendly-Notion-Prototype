{"ast":null,"code":"var __rest = this && this.__rest || function (s, e) {\n  var t = {};\n  for (var p in s) if (Object.prototype.hasOwnProperty.call(s, p) && e.indexOf(p) < 0) t[p] = s[p];\n  if (s != null && typeof Object.getOwnPropertySymbols === \"function\") for (var i = 0, p = Object.getOwnPropertySymbols(s); i < p.length; i++) {\n    if (e.indexOf(p[i]) < 0 && Object.prototype.propertyIsEnumerable.call(s, p[i])) t[p[i]] = s[p[i]];\n  }\n  return t;\n};\nimport { useMutation, useQueryClient } from '@tanstack/react-query';\nimport { useNovuContext } from './useNovuContext';\nimport { useFetchNotificationsQueryKey } from './useFetchNotificationsQueryKey';\nexport const useMarkNotificationsAs = (_a = {}) => {\n  var {\n      onSuccess,\n      query\n    } = _a,\n    options = __rest(_a, [\"onSuccess\", \"query\"]);\n  const queryClient = useQueryClient();\n  const {\n    apiService\n  } = useNovuContext();\n  const fetchNotificationsQueryKey = useFetchNotificationsQueryKey();\n  const _b = useMutation(({\n      messageId,\n      seen,\n      read\n    }) => apiService.markMessageAs(messageId, {\n      seen,\n      read\n    }), Object.assign(Object.assign({}, options), {\n      onSuccess: (newMessages, variables, context) => {\n        queryClient.setQueriesData({\n          queryKey: fetchNotificationsQueryKey,\n          exact: false\n        }, infiniteData => {\n          if (!infiniteData) {\n            return;\n          }\n          const pages = infiniteData.pages.map(page => {\n            const data = page.data.map(message => {\n              const newMessage = newMessages.find(item => item._id === message._id);\n              if (newMessage) {\n                return newMessage;\n              }\n              return message;\n            });\n            return Object.assign(Object.assign({}, page), {\n              data\n            });\n          });\n          return {\n            pageParams: infiniteData.pageParams,\n            pages\n          };\n        });\n        onSuccess === null || onSuccess === void 0 ? void 0 : onSuccess(newMessages, variables, context);\n      }\n    })),\n    {\n      mutate\n    } = _b,\n    result = __rest(_b, [\"mutate\"]);\n  return Object.assign(Object.assign({}, result), {\n    markNotificationsAs: mutate\n  });\n};","map":{"version":3,"names":["useMutation","useQueryClient","useNovuContext","useFetchNotificationsQueryKey","useMarkNotificationsAs","_a","onSuccess","query","options","__rest","queryClient","apiService","fetchNotificationsQueryKey","_b","messageId","seen","read","markMessageAs","Object","assign","newMessages","variables","context","setQueriesData","queryKey","exact","infiniteData","pages","map","page","data","message","newMessage","find","item","_id","pageParams","mutate","result","markNotificationsAs"],"sources":["../../../src/hooks/useMarkNotificationsAs.ts"],"sourcesContent":[null],"mappings":";;;;;;;;AAAA,SAASA,WAAW,EAAEC,cAAc,QAA0C,uBAAuB;AAIrG,SAASC,cAAc,QAAQ,kBAAkB;AAEjD,SAASC,6BAA6B,QAAQ,iCAAiC;AAQ/E,OAAO,MAAMC,sBAAsB,GAAGA,CAACC,EAAA,GAOoC,EAAE,KAAI;MAP1C;MACrCC,SAAS;MACTC;IAAK,IAAAF,EAKsE;IAJxEG,OAAO,GAAAC,MAAA,CAAAJ,EAAA,EAH2B,sBAItC,CADW;EAKV,MAAMK,WAAW,GAAGT,cAAc,EAAE;EACpC,MAAM;IAAEU;EAAU,CAAE,GAAGT,cAAc,EAAE;EACvC,MAAMU,0BAA0B,GAAGT,6BAA6B,EAAE;EAElE,MAAMU,EAAA,GAAwBb,WAAW,CACvC,CAAC;MAAEc,SAAS;MAAEC,IAAI;MAAEC;IAAI,CAAE,KACxBL,UAAU,CAACM,aAAa,CAACH,SAAS,EAAE;MAClCC,IAAI;MACJC;KACD,CAAC,EAAAE,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KAECX,OAAO;MACVF,SAAS,EAAEA,CAACc,WAAW,EAAEC,SAAS,EAAEC,OAAO,KAAI;QAC7CZ,WAAW,CAACa,cAAc,CACxB;UAAEC,QAAQ,EAAEZ,0BAA0B;UAAEa,KAAK,EAAE;QAAK,CAAE,EACrDC,YAAY,IAAI;UACf,IAAI,CAACA,YAAY,EAAE;YACjB;;UAGF,MAAMC,KAAK,GAAGD,YAAY,CAACC,KAAK,CAACC,GAAG,CAAEC,IAAI,IAAI;YAC5C,MAAMC,IAAI,GAAGD,IAAI,CAACC,IAAI,CAACF,GAAG,CAAEG,OAAO,IAAI;cACrC,MAAMC,UAAU,GAAGZ,WAAW,CAACa,IAAI,CAAEC,IAAI,IAAKA,IAAI,CAACC,GAAG,KAAKJ,OAAO,CAACI,GAAG,CAAC;cACvE,IAAIH,UAAU,EAAE;gBACd,OAAOA,UAAU;;cAGnB,OAAOD,OAAO;YAChB,CAAC,CAAC;YAEF,OAAAb,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KACKU,IAAI;cACPC;YAAI;UAER,CAAC,CAAC;UAEF,OAAO;YACLM,UAAU,EAAEV,YAAY,CAACU,UAAU;YACnCT;WACD;QACH,CAAC,CACF;QACDrB,SAAS,aAATA,SAAS,uBAATA,SAAS,CAAGc,WAAW,EAAEC,SAAS,EAAEC,OAAO,CAAC;MAC9C;IAAC,GAEJ;IAzCK;MAAEe;IAAM,IAAAxB,EAyCb;IAzCkByB,MAAM,GAAA7B,MAAA,CAAAI,EAAA,EAAnB,UAAqB,CAyC1B;EAED,OAAAK,MAAA,CAAAC,MAAA,CAAAD,MAAA,CAAAC,MAAA,KAAYmB,MAAM;IAAEC,mBAAmB,EAAEF;EAAM;AACjD,CAAC"},"metadata":{},"sourceType":"module","externalDependencies":[]}